# Phase 2 Process: Scope Definition
# Hybrid process - AI assists, humans decide boundaries
---
references:
  rules: ../rules/phase2-planning.md

definition:
  id: "PROC-2.1"
  name: "Scope Definition"
  description: |
    Define project scope boundaries based on Phase 1 outputs.
    This is a human-led process where AI helps structure and document scope.

    Supports two modes:
    - QUICK: Essential boundaries for small/clear projects (~20 min)
    - FULL: Detailed scope with WBS for significant investments (~2-3 hours)
  version: "1.0.0"
  phase: 2
  information_composition:
    formal: 35
    tacit: 55
    emergent: 10

interfaces:
  inputs:
    - type: "opportunity_statement"
      required: true
      description: "Output from PROC-1.1 or equivalent"
    - type: "stakeholder_map"
      required: false
      description: "Output from PROC-1.2 if available"
    - type: "mode"
      required: false
      description: "QUICK or FULL (default: QUICK)"
  outputs:
    - type: "scope_statement"
      description: "Clear definition of what is in and out of scope"
    - type: "work_breakdown"
      description: "High-level WBS (FULL mode: detailed WBS)"
    - type: "deferred_items"
      description: "Scope items marked for later phases or releases"

steps:
  # Step 1: Review Phase 1 outputs (AI-assisted)
  - id: "2.1.1"
    name: "Review Inputs"
    capability: Analyse
    pattern: AI-Led
    human_role: "Confirm Phase 1 outputs are current and complete enough"
    ai_role: "Summarise opportunity statement and identify scope-relevant elements"
    escalation_triggers:
      - condition: "Phase 1 outputs missing or unclear"
        action: RETURN
        severity: MEDIUM
        target: "PROC-1.1"
        context: "Scope definition requires clear opportunity framing. Should we revisit Phase 1?"
    completion_criteria: "Phase 1 outputs reviewed and confirmed"
    validation: "Opportunity statement available and understood"

  # Step 2: Define boundaries (Human-Led)
  - id: "2.1.2"
    name: "Define Scope Boundaries"
    capability: Elicit
    pattern: Human-Led
    human_role: "State what IS and what IS NOT in scope for this project"
    ai_role: "Prompt with boundary questions; help articulate inclusions and exclusions"
    escalation_triggers:
      - condition: "Scope too broad or vague"
        action: ESCALATE
        severity: MEDIUM
        target: human
        context: "Broad scope increases risk. Can we identify a smaller initial scope?"
      - condition: "Stakeholder disagreement on boundaries"
        action: ESCALATE
        severity: HIGH
        target: human
        context: "Scope disagreement detected. This needs resolution before proceeding."
    completion_criteria: "In-scope and out-of-scope lists exist"
    validation: "Each scope item is clearly categorised"

  # Step 3: Identify constraints (AI records, human specifies)
  - id: "2.1.3"
    name: "Identify Constraints"
    capability: Elicit
    pattern: Human-Led
    human_role: "Specify hard constraints: budget, timeline, technology, regulatory"
    ai_role: "Record and structure constraints; do not suggest or assume constraints"
    escalation_triggers:
      - condition: "Constraints conflict with scope"
        action: ESCALATE
        severity: HIGH
        target: human
        context: "Stated constraints may not support the defined scope. Scope reduction needed?"
    completion_criteria: "Key constraints documented"
    validation: "Budget, timeline, or 'no hard constraints' explicitly stated"

  # Step 4: Break down work (Partnership)
  - id: "2.1.4"
    name: "Create Work Breakdown"
    capability: Synthesise
    pattern: Partnership
    human_role: "Validate and refine AI-proposed work breakdown"
    ai_role: "Draft WBS structure based on scope and constraints"
    escalation_triggers:
      - condition: "Work breakdown too detailed for current phase"
        action: DEFER
        severity: LOW
        target: "2.1.6"
        context: "Detailed breakdown may be premature. Capture high-level structure now, refine later."
    completion_criteria: "High-level work breakdown exists"
    validation: "WBS covers all in-scope items"

  # Step 5: Validate against stakeholders (Human-Led)
  - id: "2.1.5"
    name: "Validate Scope"
    capability: Validate
    pattern: Human-Led
    human_role: "Confirm scope aligns with stakeholder expectations"
    ai_role: "Summarise scope for validation; highlight potential gaps"
    escalation_triggers:
      - condition: "Stakeholder rejection or significant concerns"
        action: RETURN
        severity: HIGH
        target: "2.1.2"
        context: "Scope needs revision based on stakeholder feedback"
    completion_criteria: "Scope validated with key stakeholders"
    validation: "No unresolved stakeholder objections"

  # Step 6: Record deferrals (AI-Led)
  - id: "2.1.6"
    name: "Record Deferrals"
    capability: Preserve
    pattern: AI-Led
    human_role: "Confirm deferrals and rationale"
    ai_role: "Compile out-of-scope items with revisit criteria"
    escalation_triggers:
      - condition: "Critical items deferred without mitigation"
        action: ESCALATE
        severity: MEDIUM
        target: human
        context: "Important items are deferred. Is this acceptable or do we need to adjust scope?"
    completion_criteria: "Deferrals documented with rationale"
    validation: "Each deferral has owner and revisit trigger"

control_flow:
  retry_policy:
    on_validation_failure:
      return_to: "2.1.2"
      max_iterations: 2
  mode_variations:
    QUICK:
      skip_steps: []
      time_budget_minutes: 20
      depth: "Essential boundaries; high-level WBS only"
    FULL:
      skip_steps: []
      time_budget_minutes: 150
      depth: "Detailed boundaries; comprehensive WBS"

quality:
  entry_criteria:
    - "Phase 1 opportunity statement available"
    - "Human with scope authority available"
  exit_criteria:
    - "Scope boundaries defined (in/out)"
    - "Work breakdown at appropriate level"
  sla:
    expected_duration_minutes: 20
    timeout_minutes: 180
    warning_threshold_percent: 80

progressive_disclosure:
  initial_mode: QUICK
  upgrade_triggers:
    - "Complex or unclear boundaries identified"
    - "Multiple stakeholder interests in scope"
    - "Significant budget or timeline constraints"
    - "Human requests detailed breakdown"
  upgrade_prompt: |
    The scope has some complexity. Would you like to switch to FULL mode
    for a more detailed breakdown? This helps clarify boundaries and
    creates a foundation for scheduling.

flow: |
  ```mermaid
  flowchart TD
    subgraph Steps
      S1["2.1.1 Review Inputs<br/>(Analyse, AI-Led)"]
      S2["2.1.2 Define Boundaries<br/>(Elicit, Human-Led)"]
      S3["2.1.3 Identify Constraints<br/>(Elicit, Human-Led)"]
      S4["2.1.4 Create WBS<br/>(Synthesise, Partnership)"]
      S5["2.1.5 Validate Scope<br/>(Validate, Human-Led)"]
      S6["2.1.6 Record Deferrals<br/>(Preserve, AI-Led)"]
    end

    S1 --> S2
    S2 --> S3
    S3 --> S4
    S4 --> S5
    S5 --> S6

    S1 -->|"Missing inputs"| RET1[Return to PROC-1.1]
    S2 -->|"Too broad"| ESC1[Escalate: reduce scope]
    S3 -->|"Conflicts"| ESC2[Escalate: constraint conflict]
    S4 -->|"Too detailed"| DEF[Defer to 2.1.6]
    S5 -->|"Rejected"| S2

    S6 --> OUT[Scope Statement + WBS + Deferrals]
  ```
---
